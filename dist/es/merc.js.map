{"version":3,"file":"merc.js","sources":["../../../proj4js/lib/projections/merc.js","../../../proj4js/lib/common/msfnz.js","../../../proj4js/lib/common/tsfnz.js","../../../proj4js/lib/common/phi2z.js","../../merc.js"],"sourcesContent":["import msfnz from '../common/msfnz';\n\nimport adjust_lon from '../common/adjust_lon';\nimport tsfnz from '../common/tsfnz';\nimport phi2z from '../common/phi2z';\nimport {FORTPI, R2D, EPSLN, HALF_PI} from '../constants/values';\nexport function init() {\n  var con = this.b / this.a;\n  this.es = 1 - con * con;\n  if(!('x0' in this)){\n    this.x0 = 0;\n  }\n  if(!('y0' in this)){\n    this.y0 = 0;\n  }\n  this.e = Math.sqrt(this.es);\n  if (this.lat_ts) {\n    if (this.sphere) {\n      this.k0 = Math.cos(this.lat_ts);\n    }\n    else {\n      this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));\n    }\n  }\n  else {\n    if (!this.k0) {\n      if (this.k) {\n        this.k0 = this.k;\n      }\n      else {\n        this.k0 = 1;\n      }\n    }\n  }\n}\n\n/* Mercator forward equations--mapping lat,long to x,y\n  --------------------------------------------------*/\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  // convert to radians\n  if (lat * R2D > 90 && lat * R2D < -90 && lon * R2D > 180 && lon * R2D < -180) {\n    return null;\n  }\n\n  var x, y;\n  if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {\n    return null;\n  }\n  else {\n    if (this.sphere) {\n      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n      y = this.y0 + this.a * this.k0 * Math.log(Math.tan(FORTPI + 0.5 * lat));\n    }\n    else {\n      var sinphi = Math.sin(lat);\n      var ts = tsfnz(this.e, lat, sinphi);\n      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n      y = this.y0 - this.a * this.k0 * Math.log(ts);\n    }\n    p.x = x;\n    p.y = y;\n    return p;\n  }\n}\n\n/* Mercator inverse equations--mapping x,y to lat/long\n  --------------------------------------------------*/\nexport function inverse(p) {\n\n  var x = p.x - this.x0;\n  var y = p.y - this.y0;\n  var lon, lat;\n\n  if (this.sphere) {\n    lat = HALF_PI - 2 * Math.atan(Math.exp(-y / (this.a * this.k0)));\n  }\n  else {\n    var ts = Math.exp(-y / (this.a * this.k0));\n    lat = phi2z(this.e, ts);\n    if (lat === -9999) {\n      return null;\n    }\n  }\n  lon = adjust_lon(this.long0 + x / (this.a * this.k0));\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Mercator\", \"Popular Visualisation Pseudo Mercator\", \"Mercator_1SP\", \"Mercator_Auxiliary_Sphere\", \"merc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function(eccent, sinphi, cosphi) {\n  var con = eccent * sinphi;\n  return cosphi / (Math.sqrt(1 - con * con));\n}","import {HALF_PI} from '../constants/values';\n\nexport default function(eccent, phi, sinphi) {\n  var con = eccent * sinphi;\n  var com = 0.5 * eccent;\n  con = Math.pow(((1 - con) / (1 + con)), com);\n  return (Math.tan(0.5 * (HALF_PI - phi)) / con);\n}\n","import {HALF_PI} from '../constants/values';\n\nexport default function(eccent, ts) {\n  var eccnth = 0.5 * eccent;\n  var con, dphi;\n  var phi = HALF_PI - 2 * Math.atan(ts);\n  for (var i = 0; i <= 15; i++) {\n    con = eccent * Math.sin(phi);\n    dphi = HALF_PI - 2 * Math.atan(ts * (Math.pow(((1 - con) / (1 + con)), eccnth))) - phi;\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n  //console.log(\"phi2z has NoConvergence\");\n  return -9999;\n}\n","import merc from '../proj4js/lib/projections/merc.js';\nimport proj4 from '../proj4js/lib/index.js';\n\nproj4.Proj.projections.add(merc);\n"],"names":["init","con","this","b","a","es","x0","y0","e","Math","sqrt","lat_ts","sphere","k0","cos","eccent","sinphi","cosphi","msfnz","sin","k","forward","p","x","y","lon","lat","R2D","abs","HALF_PI","EPSLN","adjust_lon","long0","log","tan","FORTPI","ts","phi","com","pow","tsfnz","inverse","atan","exp","dphi","eccnth","i","phi2z","names","proj4","Proj","projections","add","merc"],"mappings":"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"}